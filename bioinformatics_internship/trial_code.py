'''
Created on 27 Feb 2018

@author: filipe
'''
import pandas as pd
import numpy as np
import useful
import matplotlib.pyplot as plt 
from Bio import SeqIO, Seq

codon_dict = {'CYS': {'UGU': 0.9964654319242189, 'UGC': 1.0035345680757812}, 
  'ASP': {'GAU': 0.9641563246743236, 'GAC': 1.0358436753256763}, 
  'SER': {'UCU': 1.2508559498956158, 'UCG': 0.26129436325678496, 'UCA': 0.9722755741127349, 'UCC': 1.2849269311064717, 'AGC': 1.2997077244258872, 'AGU': 0.9309394572025053}, 
  'GLN': {'CAA': 0.617055947854427, 'CAG': 1.3829440521455731}, 
  'MET': {'AUG': 1.0}, 
  'ASN': {'AAC': 1.0459035444509006, 'AAU': 0.9540964555490994}, 
  'PRO': {'CCU': 1.2386759581881532, 'CCG': 0.40816326530612246, 'CCA': 1.2098058735689399, 'CCC': 1.1433549029367844}, 
  'LYS': {'AAG': 1.1334190231362469, 'AAA': 0.8665809768637532}, 
  'THR': {'ACC': 1.2812793979303858, 'ACA': 1.2361241768579492, 'ACG': 0.36742373336917084, 'ACU': 1.1151726918424942}, 
  'PHE': {'UUU': 0.9312772974418397, 'UUC': 1.0687227025581603}, 
  'ALA': {'GCA': 0.9815144165992994, 'GCC': 1.395203449205066, 'GCG': 0.4022635408245756, 'GCU': 1.2210185933710591}, 
  'GLY': {'GGU': 0.6906378715351219, 'GGG': 0.9270844929310921, 'GGA': 1.146832906601358, 'GGC': 1.235444728932428}, 
  'ILE': {'AUC': 1.3143115942028984, 'AUA': 0.5939764492753623, 'AUU': 1.091711956521739}, 
  'LEU': {'UUA': 0.47214557647305366, 'UUG': 0.8499877754881073, 'CUC': 1.1320596556180365, 'CUU': 0.8963012119730362, 'CUG': 2.121197303621948, 'CUA': 0.5283084768258182}, 
  'HIS': {'CAU': 0.8555787278415016, 'CAC': 1.1444212721584985}, 
  'ARG': {'CGA': 0.6365583025111933, 'CGC': 0.8989682694179483, 'CGG': 0.938680163519564, 'CGU': 0.4605801051197197, 'AGG': 1.4716760755304652, 'AGA': 1.5935370839011096}, 
  'TRP': {'UGG': 1.0}, 
  'VAL': {'GUA': 0.5206755969714618, 'GUC': 1.011764705882353, 'GUG': 1.6617355853232383, 'GUU': 0.805824111822947}, 
  'GLU': {'GAG': 1.098732273313279, 'GAA': 0.9012677266867211}, 
  'TYR': {'UAU': 0.9385417992110956, 'UAC': 1.0614582007889044}
  }






        
def plot_stacked_codons(codon_dict):
    
    df = pd.DataFrame.from_dict(codon_dict, orient='index')
    print (df)
    
    
    colours = ['k', 'b', 'm', 'c', 'r' 'y']
    
    df.plot.bar(stacked = True, color = colours)
    plt.show()



if __name__ == '__main__':
    file = 'tumours_clean.xlsx'
    title = 'Cell Lines: Mock vs Wt'
    sheet_up = 'Mock vs Wt up'
    sheet_down = 'Mock vs Wt down'
    plot_stacked_codons(codon_dict)




